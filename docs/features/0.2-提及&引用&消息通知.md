## 消息盒子

消息盒子 `Notice` 用来维护用户消息以及 `已读` 和 `未读` 的状态

### 消息类型

| 消息类型 | 标识符       | 说明         |
|------|-----------|------------|
| 提及   | mention   | 用户被提及的消息   |
| 引用   | reference | 用户消息被引用的消息 |

### 通知机制

* 前端读取消息列表
* 通过 ws 通道推送新消息 trigger，触发前端拉取最新未读数

### 消息定位

根据消息的 `businessId` 和消息类型，可确定唯一实体

### 消息已读

前端主动标记消息已读

### 公共能力

* 对其他模块提供消息发送接口
* 对外提供消息标记已读接口
* 对外提供消息查询接口
* 提供对用户的消息通知能力

## 提及 功能

### 约定

在消息提嵌入一段包含用户信息的标签，进行占位替换，匹配到此标签的，表明在提及用户

### 标签

```@[{userId}]```

### 示例

提及 `userId` 为 `32` 的用户

```@[32]```

### 正则

```regexp
@\\[\\d+]
```

### 提及通知

使用 `Notice` 进行通知

## 消息引用 功能

`MessageRecord` 增加字段指定引用的消息ID

## 消息通知

使用 `Notice`



